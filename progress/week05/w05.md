# Tuần 5 — Mô hình cơ sở (Baseline)

Mục tiêu
- Xây mô hình đơn giản để có mốc so sánh cho các bước tiếp theo.

Việc cần làm
- Chia dữ liệu (ví dụ 80/20) hoặc dùng 5‑fold cross‑validation.
- Huấn luyện Logistic Regression (hoặc model đơn giản), tính Accuracy/Precision/Recall/F1.
- Ghi nhận kết quả để so sánh với mô hình nâng cao.

Giao nộp
- Kết quả baseline và giải thích ngắn về ý nghĩa các metric.

Checklist
- [ ] Chia train/test hoặc CV
- [ ] Huấn luyện model baseline
- [ ] Ghi báo cáo kết quả

### Todo List Đơn Giản Hóa cho Tuần 5: Modeling

1. **Chuẩn bị môi trường và dữ liệu**  
   - **Cần làm gì**: Tải `clean_movies_features.csv`, chia thành train/test (80/20), áp dụng Min-Max Scaler, xử lý mất cân bằng lớp.  
   - **Xác định gì**: Tỷ lệ lớp Success/Failure trong train/test để đảm bảo stratified.  
   - **Tìm hiểu gì**: Cách stratified sampling và SMOTE/class weighting để cân bằng dữ liệu.

2. **Xây dựng mô hình cơ sở (Logistic Regression)**  
   - **Cần làm gì**: Triển khai Logistic Regression, huấn luyện trên train, đánh giá trên test.  
   - **Xác định gì**: Kết quả Accuracy, Precision, Recall, F1-Score ban đầu.  
   - **Tìm hiểu gì**: Nguyên lý Logistic Regression và vai trò làm baseline.

3. **Xây dựng mô hình chính (Random Forest)**  
   - **Cần làm gì**: Triển khai Random Forest, huấn luyện và đánh giá tương tự.  
   - **Xác định gì**: So sánh hiệu suất với Logistic Regression.  
   - **Tìm hiểu gì**: Cách Random Forest kết hợp cây quyết định để giảm overfitting.

4. **Áp dụng Cross-Validation (5-Fold)**  
   - **Cần làm gì**: Chạy 5-Fold CV cho cả hai mô hình.  
   - **Xác định gì**: Confidence interval cho Accuracy/F1-Score, dấu hiệu overfitting.  
   - **Tìm hiểu gì**: Ý nghĩa của cross-validation trong đánh giá mô hình nhỏ.

5. **Phân tích Feature Importance**  
   - **Cần làm gì**: Tính tầm quan trọng đặc trưng từ Random Forest, trực quan hóa.  
   - **Xác định gì**: Top features ảnh hưởng (vd: Budget, Vote_Count).  
   - **Tìm hiểu gì**: Cách feature importance giúp hiểu yếu tố thành công phim.

6. **Phân tích lỗi**  
   - **Cần làm gì**: Xây dựng Confusion Matrix, phân tích False Positives/Negatives.  
   - **Xác định gì**: Tác động kinh tế của từng loại lỗi.  
   - **Tìm hiểu gì**: Ý nghĩa thực tiễn của error analysis trong dự đoán phim.

7. **So sánh và lựa chọn mô hình cuối**  
   - **Cần làm gì**: So sánh dựa trên F1-Score, chọn và lưu mô hình (dự kiến Random Forest).  
   - **Xác định gì**: Mô hình tốt nhất và lý do chọn.  
   - **Tìm hiểu gì**: Sự cân bằng giữa accuracy và khả năng giải thích.

8. **Viết báo cáo và review**  
   - **Cần làm gì**: Tóm tắt kết quả, cập nhật `todo.md`, chạy lại pipeline.  
   - **Xác định gì**: Các điểm mạnh/yếu của mô hình.  
   - **Tìm hiểu gì**: Cách viết báo cáo khoa học cho đồ án.

## Kết Quả Thực Hiện Tuần 5

### 1. Chuẩn Bị Môi Trường và Dữ Liệu
- **Những gì đã làm**: Tải `clean_movies_features.csv` (1020 hàng, 65 cột), loại bỏ cột không cần thiết (Id, Title), chọn 47 features số, chia train/test 80/20 với stratified sampling, áp dụng Min-Max Scaler, xử lý NaN bằng fillna(0), dữ liệu cân bằng nên không dùng SMOTE. Lưu dữ liệu vào `train_test_data.pkl`.
- **Công dụng**: Chuẩn bị dữ liệu sạch, chuẩn hóa để tránh bias từ scale khác nhau, đảm bảo train/test đại diện cho phân phối lớp.
- **Ảnh hưởng**: Giúp mô hình hội tụ nhanh hơn, giảm overfitting từ features có scale lớn (như Revenue, Budget).
- **Những gì đã rút ra được**: Stratified sampling quan trọng cho dữ liệu imbalance nhẹ; Min-Max Scaler phù hợp cho Logistic Regression; xử lý NaN sớm tránh lỗi runtime.
- **Lưu ý**: Luôn kiểm tra tỷ lệ lớp sau chia; dùng pickle để tái sử dụng dữ liệu hiệu quả; cập nhật feature_names trong pickle để dùng cho feature importance.

### 2. Xây Dựng Mô Hình Cơ Sở (Logistic Regression)
- **Những gì đã làm**: Huấn luyện LogisticRegression với default params trên train set, đánh giá trên test: Accuracy 0.8480, F1-Score 0.8480. Lưu model vào `logistic_model.pkl` và kết quả vào `logistic_results.txt`.
- **Công dụng**: Thiết lập baseline đơn giản, dễ giải thích, để so sánh với mô hình phức tạp hơn.
- **Ảnh hưởng**: Cung cấp mốc tham chiếu; Logistic Regression hoạt động tốt trên dữ liệu tuyến tính, nhưng có thể underfit nếu dữ liệu phức tạp.
- **Những gì đã rút ra được**: Accuracy ~85% là baseline khá tốt; F1 cân bằng precision/recall; Logistic Regression phù hợp làm starting point.
- **Lưu ý**: Theo dõi overfitting qua train/val gap; dùng classification_report để hiểu chi tiết precision/recall; lưu model để tái sử dụng.

### 3. Xây Dựng Mô Hình Chính (Random Forest)
- **Những gì đã làm**: Huấn luyện RandomForestClassifier (100 trees, default) trên train, đánh giá trên test: Accuracy 0.9951, F1-Score 0.9951. So sánh với Logistic (cải thiện 0.1471). Lưu model vào `random_forest_model.pkl` và kết quả vào `random_forest_results.txt`.
- **Công dụng**: Mô hình ensemble mạnh, xử lý non-linear tốt, giảm overfitting qua averaging trees.
- **Ảnh hưởng**: Hiệu suất vượt trội (gần 100%), nhưng có thể overfit nếu không tune; Random Forest ít nhạy cảm với outliers so với Logistic.
- **Những gì đã rút ra được**: Random Forest vượt Logistic đáng kể trên dataset này; ensemble methods hiệu quả cho tabular data; cần CV để xác nhận không overfit.
- **Lưu ý**: Tune n_estimators, max_depth để tối ưu; so sánh với baseline trước khi chọn; lưu model để feature analysis.

### 4. Áp Dụng Cross-Validation (5-Fold)
- **Những gì đã làm**: Chạy 5-Fold CV cho cả Logistic và RF, tính mean/std Accuracy/F1, kiểm tra overfitting gap (train-val). Logistic: Acc 0.8441 ± 0.0351, F1 0.8416 ± 0.0333; RF: Acc 0.9941 ± 0.0141, F1 0.9941 ± 0.0141. Không overfitting rõ rệt. Lưu vào `cv_results.txt`.
- **Công dụng**: Đánh giá ổn định mô hình trên nhiều folds, tính confidence interval, phát hiện overfitting.
- **Ảnh hưởng**: Xác nhận RF ổn định hơn Logistic (std thấp hơn); CI cho biết độ tin cậy của kết quả trên dataset nhỏ.
- **Những gì đã rút ra được**: CV quan trọng cho dataset nhỏ để tránh overestimation; RF ít biến động hơn; gap train-val nhỏ cho thấy không overfit.
- **Lưu ý**: Dùng stratified CV cho imbalance; so sánh std giữa models; CV tốn thời gian nhưng cần thiết cho reliability.

### 5. Phân Tích Feature Importance
- **Những gì đã làm**: Tính feature_importances_ từ RF, top 10: Vote Average (41.56%), roi_vs_vote (10.70%), roi (7.05%), etc. Lưu vào `feature_importance.txt`.
- **Công dụng**: Xác định features quan trọng nhất ảnh hưởng đến success, hướng dẫn feature engineering.
- **Ảnh hưởng**: Vote Average là yếu tố chính, theo logic (phim hay được vote cao); giúp hiểu domain knowledge (budget, genre ít quan trọng hơn vote).
- **Những gì đã rút ra được**: Audience vote quan trọng hơn budget/genre; feature engineering đã tạo ra features tốt (roi_vs_vote); RF cung cấp insights dễ hiểu.
- **Lưu ý**: Chỉ áp dụng cho tree-based models; visualize nếu có thể; dùng để loại features ít quan trọng nếu cần.

### 6. Phân Tích Lỗi
- **Những gì đã làm**: Tạo confusion matrix, classification report cho cả Logistic và RF. Logistic: 31 lỗi (FP+FN), RF: chỉ 1 lỗi. Phân tích misclassified samples (top features: genre_Comedy, etc.). Lưu vào `error_analysis.txt`.
- **Công dụng**: Hiểu loại lỗi (FP: dự đoán success nhưng fail; FN: ngược lại), cải thiện mô hình.
- **Ảnh hưởng**: RF gần perfect, ít lỗi; Logistic có nhiều FN (thiếu success), có thể tune threshold.
- **Những gì đã rút ra được**: Error analysis cho insights thực tế (ví dụ, comedy films dễ misclassify); RF robust hơn; cần domain knowledge để giải thích lỗi.
- **Lưu ý**: Tập trung vào FN nếu cost cao (bỏ lỡ phim thành công); dùng error analysis để refine features; visualize confusion matrix.

### 7. So Sánh và Lựa Chọn Mô Hình Cuối
- **Những gì đã làm**: So sánh dựa trên accuracy, F1, CV stability, overfitting, interpretability, cost. Chọn RF làm final model (lưu `best_model.pkl`), cải thiện 14.71% so với Logistic. Lưu vào `model_selection.txt`.
- **Công dụng**: Lựa chọn mô hình tốt nhất cho production, cân bằng performance và practicality.
- **Ảnh hưởng**: RF được chọn cho hiệu suất cao, ổn định; Logistic giữ lại làm baseline.
- **Những gì đã rút ra được**: Performance outweighs interpretability; CV stability quan trọng; ensemble methods tốt cho tabular data.
- **Lưu ý**: Cân bằng accuracy vs explainability; test trên unseen data; lưu best model để deploy.

### 8. Viết Báo Cáo và Review
- **Những gì đã làm**: Tổng hợp tất cả kết quả vào `week5_report.txt`, cập nhật todo list, review pipeline.
- **Công dụng**: Ghi lại tiến trình, lessons learned, chuẩn bị cho tuần sau.
- **Ảnh hưởng**: Giúp track progress, cải thiện workflow; báo cáo khoa học tăng credibility.
- **Những gì đã rút ra được**: Pipeline modeling hoàn chỉnh; RF vượt trội cho task này; cần automation cho reproducibility.
- **Lưu ý**: Viết báo cáo rõ ràng, concise; include metrics và insights; update README nếu cần.

**Tóm Tắt Chung**: Tuần 5 hoàn thành với RF làm model cuối (Acc 99.51%), vượt Logistic baseline. Rút ra: preprocessing quan trọng, CV cần thiết, feature analysis hữu ích. Lưu ý: Tune hyperparameters, test robustness, chuẩn bị cho deployment. Dự án sẵn sàng cho tuần 6+.

